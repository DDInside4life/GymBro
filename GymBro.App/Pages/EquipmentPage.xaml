<Page x:Class="GymBro.App.Pages.EquipmentPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:vm="clr-namespace:GymBro.App.ViewModels"
      Title="Оборудование">
    <Page.DataContext>
        <vm:EquipmentPageViewModel />
    </Page.DataContext>

    <Page.Resources>
        <Style x:Key="AdminButtonStyle" TargetType="Button" BasedOn="{StaticResource PrimaryButtonStyle}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsAdmin}" Value="False">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Page.Resources>

    <Grid Background="#F5F7FA">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Левая колонка: список оборудования -->
        <Border Grid.Column="0" Margin="30,30,15,30" Background="White" CornerRadius="15" Padding="20">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Text="Оборудование" FontSize="24" FontWeight="SemiBold" Foreground="#2C3E50" Margin="0,0,0,20"/>
                <ListBox Grid.Row="1" ItemsSource="{Binding EquipmentList}" 
                         SelectedItem="{Binding SelectedEquipment}"
                         Style="{StaticResource CardListBoxStyle}"
                         ItemContainerStyle="{StaticResource CardListItemStyle}">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <TextBlock Text="{Binding Name}" FontSize="16" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding Description}" FontSize="12" Foreground="#7F8C8D"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>

                <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
                    <Button Content="➕ Добавить" Command="{Binding AddEquipmentCommand}" 
                            Style="{StaticResource AdminButtonStyle}" Padding="15,8"/>
                    <Button Content="✏️ Редактировать" Command="{Binding EditEquipmentCommand}" 
                            Style="{StaticResource AdminButtonStyle}" Padding="15,8" Margin="10,0,0,0"/>
                    <Button Content="🗑 Удалить" Command="{Binding DeleteEquipmentCommand}" 
                            Style="{StaticResource AdminButtonStyle}" Padding="15,8" Margin="10,0,0,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Правая колонка: упражнения, использующие выбранное оборудование -->
        <Border Grid.Column="1" Margin="15,30,30,30" Background="White" CornerRadius="15" Padding="20">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Text="Упражнения" FontSize="24" FontWeight="SemiBold" Foreground="#2C3E50" Margin="0,0,0,20">
                    <Run Text="{Binding SelectedEquipment.Name, FallbackValue=''}" Foreground="#3498DB"/>
                </TextBlock>

                <ListBox Grid.Row="1" ItemsSource="{Binding ExercisesForSelected}" 
                         Style="{StaticResource CardListBoxStyle}"
                         ItemContainerStyle="{StaticResource CardListItemStyle}">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <TextBlock Text="{Binding Name}" FontSize="16" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding DefaultSets, StringFormat='Подходы: {0}'}" FontSize="12" Foreground="#7F8C8D"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </Border>
    </Grid>
</Page>